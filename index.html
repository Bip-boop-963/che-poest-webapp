<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ß—ë –ø–æ–µ—Å—Ç—å?</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root {
  --wheel-size: min(320px, 85vw);
  --pointer-size: 30px;
}

@keyframes gradientAnimation {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background: linear-gradient(-45deg, #fbc2eb, #a6c1ee, #cfbaf0, #a8c0ff);
  background-size: 400% 400%;
  animation: gradientAnimation 10s ease infinite;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

/* –ó–∞–≥—Ä—É–∑–∫–∞ */
.loader { display: flex; gap: 10px; }
.dot { width: 20px; height: 20px; background: #ffb74d; border-radius: 50%; animation: bounce 0.6s infinite alternate; }
.dot:nth-child(2) { animation-delay: 0.2s; }
.dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes bounce { to { transform: translateY(-20px); background: #ffa726; } }

/* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
#menu-container { display: none; flex-direction: column; align-items: center; width: 100%; padding: 20px; box-sizing: border-box; position: relative; }
.categories { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; margin-bottom: 20px; }

/* --- –û–ë–©–ò–ô –°–¢–ò–õ–¨ "–ñ–ò–î–ö–û–ï –°–¢–ï–ö–õ–û" --- */
.category, .dish, #back-button, .control-btn, #back-roulette {
  background: rgba(255, 255, 255, 0.4);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 15px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  cursor: pointer;
  transition: transform 0.2s, background 0.2s;
  user-select: none;
}
.category:hover, .dish:hover, #back-button:hover, .control-btn:hover, #back-roulette:hover {
  transform: scale(1.1);
  background: rgba(255, 255, 255, 0.6);
}

.category { font-size: 1.4em; padding: 12px 20px; }
.dishes { display: none; flex-direction: column; align-items: center; gap: 10px; margin-bottom: 20px; }
.dishes.show { display: flex; }
.dish { font-size: 1.4em; padding: 10px 20px; }

#back-button { font-size: 2em; position: fixed; top: 20px; left: 20px; padding: 10px 15px; display: none; z-index: 10; }

/* –ö–æ–Ω—Ç—Ä–æ–ª—ã */
#controls { display: flex; gap: 20px; margin-bottom: 20px; }
.control-btn { width: 60px; height: 60px; font-size: 2em; display: flex; align-items: center; justify-content: center; }
.control-btn:disabled { background: #e0e0e0; cursor: not-allowed; }

/* –°–ø–∏—Å–æ–∫ */
#list-box {
  display: none;
  margin-top: 20px;
  background: rgba(255, 255, 255, 0.4);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  padding: 15px 20px;
  border-radius: 15px;
  width: 250px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  position: relative;
}
#list-box h2 { text-align: center; margin:0 0 10px; }
#list { list-style-type: none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px; font-size:1.2em; text-align:left; }
#checkout-btn { position: absolute; bottom: 10px; right: 10px; font-size: 2em; border: none; background: transparent; cursor: pointer; }

/* --- –†–£–õ–ï–¢–ö–ê (–û–ë–ù–û–í–õ–ï–ù–ù–´–ï –°–¢–ò–õ–ò) --- */
#wheel-container { display: none; flex-direction: column; align-items: center; justify-content: center; gap: 30px; width: 100%; height: 100%; }
.wheel-wrapper { position: relative; width: var(--wheel-size); aspect-ratio: 1 / 1; max-width: var(--wheel-size); max-height: var(--wheel-size); }

/* 1. –ö–†–ê–°–ù–´–ô –°–¢–ï–ö–õ–Ø–ù–ù–´–ô –£–ö–ê–ó–ê–¢–ï–õ–¨ */
#wheel-pointer {
  width: 0;
  height: 0;
  border-style: solid;
  border-width: var(--pointer-size) 0 var(--pointer-size) var(--pointer-size);
  /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç */
  border-color: transparent transparent transparent rgba(255, 65, 54, 0.7);
  position: absolute;
  top: 50%;
  left: -10px;
  transform: translateY(-50%);
  z-index: 10;
  filter: drop-shadow(2px 2px 3px rgba(0,0,0,0.4));
}

/* 2. –°–ò–ù–Ø–Ø –°–¢–ï–ö–õ–Ø–ù–ù–ê–Ø –†–ê–ú–ö–ê –ö–û–õ–ï–°–ê */
#wheel {
  width: 100%;
  height: 100%;
  background-image: conic-gradient(red 0deg, blue 360deg);
  border-radius: 50%;
  /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Å–∏–Ω–∏–π —Ü–≤–µ—Ç –¥–ª—è —Ä–∞–º–∫–∏ */
  border: 10px solid rgba(100, 149, 237, 0.7);
  /* –í–Ω–µ—à–Ω—è—è —Ç–µ–Ω—å + —Å–∏–Ω—è—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ç–µ–Ω—å –¥–ª—è "—Å–≤–µ—á–µ–Ω–∏—è" */
  box-shadow: 0 0 15px rgba(0,0,0,0.3), inset 0 0 10px rgba(100, 149, 237, 0.8);
  position: relative;
  overflow: hidden;
  transition: transform 5s cubic-bezier(0.15, 0.75, 0.3, 1);
}

.wheel-labels { position: absolute; top:0; left:0; width: 100%; height: 100%; }
.wheel-label-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.wheel-label-text {
  position: absolute;
  top: 10%;
  left: 50%;
  transform: translateX(-50%) rotate(90deg);
  font-size: 14px;
  font-weight: bold;
  user-select: none;
  color: #333;
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.7);
}

#back-roulette { position: fixed; top: 20px; left: 20px; z-index: 20; font-size: 2em; padding: 10px 15px; }

/* --- –°–¢–ò–õ–ò –î–õ–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø --- */
#notification-toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translate(-50%, 150%);
  background: rgba(30, 30, 30, 0.7);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  padding: 12px 24px;
  border-radius: 25px;
  font-size: 1.2em;
  font-weight: 500;
  z-index: 1000;
  opacity: 0;
  transition: transform 0.5s cubic-bezier(0.215, 0.610, 0.355, 1), opacity 0.5s ease;
  pointer-events: none;
}

#notification-toast.show {
  transform: translate(-50%, 0);
  opacity: 1;
}

</style>
</head>
<body>

<div class="loader"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>

<div id="menu-container">
  <div class="categories">
    <div class="category" data-category="first">üç≤ –ü–µ—Ä–≤–æ–µ</div>
    <div class="category" data-category="second">ü•ò –í—Ç–æ—Ä–æ–µ</div>
    <div class="category" data-category="salads">ü•ó –°–∞–ª–∞—Ç—ã</div>
    <div class="category" data-category="breakfast">üç≥ –ó–∞–≤—Ç—Ä–∞–∫–∏</div>
    <div class="category" data-category="tea">üç∞ –ö —á–∞—é</div>
  </div>
  <button id="back-button">‚¨ÖÔ∏è</button>
  <div id="dishes-container">
    <div class="dishes" data-category="first"><div class="dish" data-name="üç≤ –ë–æ—Ä—â">üç≤ –ë–æ—Ä—â</div><div class="dish" data-name="üçú –õ–∞–ø—à–∞">üçú –õ–∞–ø—à–∞</div></div>
    <div class="dishes" data-category="second"><div class="dish" data-name="üçõ –ü–ª–æ–≤">üçõ –ü–ª–æ–≤</div><div class="dish" data-name="ü•© –ú—è—Å–æ —Å –∞–Ω–∞–Ω–∞—Å–∞–º–∏">ü•© –ú—è—Å–æ —Å –∞–Ω–∞–Ω–∞—Å–∞–º–∏</div></div>
    <div class="dishes" data-category="salads"><div class="dish" data-name="ü•ó –ü–æ–ª—è–Ω–∫–∞">ü•ó –ü–æ–ª—è–Ω–∫–∞</div></div>
    <div class="dishes" data-category="breakfast"><div class="dish" data-name="üç≥ –Ø–∏—á–Ω–∏—Ü–∞">üç≥ –Ø–∏—á–Ω–∏—Ü–∞</div><div class="dish" data-name="ü•ü –ö–æ–Ω–≤–µ—Ä—Ç–∏–∫–∏">ü•ü –ö–æ–Ω–≤–µ—Ä—Ç–∏–∫–∏</div></div>
    <div class="dishes" data-category="tea"><div class="dish" data-name="üç∞ –ß–∏–∑–∫–µ–π–∫">üç∞ –ß–∏–∑–∫–µ–π–∫</div><div class="dish" data-name="ü•ß –ü–∏—Ä–æ–≥">ü•ß –ü–∏—Ä–æ–≥</div></div>
  </div>
  <div id="controls"><button id="rouletteBtn" class="control-btn">üé≤</button><button id="clear" class="control-btn">üóë</button></div>
  <div id="list-box"><h2>üìù –°–ø–∏—Å–æ–∫</h2><ul id="list"></ul><button id="checkout-btn">üõí</button></div>
</div>

<div id="wheel-container">
  <div class="wheel-wrapper">
    <div id="wheel"><div class="wheel-labels"></div></div>
    <div id="wheel-pointer"></div>
  </div>
  <button id="spinBtn" class="control-btn">üé≤</button>
  <button id="back-roulette">‚¨ÖÔ∏è</button>
</div>

<div id="notification-toast"></div>

<script>
// –û–ë–©–ê–Ø –õ–û–ì–ò–ö–ê
const categories = document.querySelectorAll('.category'), dishesContainers = document.querySelectorAll('.dishes'), allDishes = document.querySelectorAll('.dish'), cart = document.getElementById('list'), listBox = document.getElementById('list-box'), backButton = document.getElementById('back-button'), checkoutBtn = document.getElementById('checkout-btn');

// –õ–û–ì–ò–ö–ê –†–£–õ–ï–¢–ö–ò
const wheelContainer = document.getElementById('wheel-container'), rouletteBtn = document.getElementById('rouletteBtn'), wheel = document.getElementById('wheel'), wheelLabelsContainer = document.querySelector('.wheel-labels'), spinBtn = document.getElementById('spinBtn'), backRoulette = document.getElementById('back-roulette');
const dishNames = Array.from(allDishes).map(d => d.dataset.name);
const colors = ["#FFDDC1", "#FFFACD", "#D4F0F0", "#F0E68C", "#E6E6FA", "#FFC0CB", "#B0E0E6", "#F5DEB3", "#98FB98", "#F08080", "#ADD8E6", "#FFB6C1"];
let isSpinning = false, currentRotation = 0;

// –õ–û–ì–ò–ö–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
const notificationToast = document.getElementById('notification-toast');
let notificationTimer;

function showNotification(message) {
  clearTimeout(notificationTimer);
  notificationToast.textContent = message;
  notificationToast.classList.add('show');
  notificationTimer = setTimeout(() => {
    notificationToast.classList.remove('show');
  }, 3000);
}

function createWheel() {
  wheelLabelsContainer.innerHTML = '';
  const numItems = dishNames.length, segmentAngle = 360 / numItems;
  let gradientString = 'conic-gradient(';
  dishNames.forEach((name, i) => {
    const color = colors[i % colors.length], startAngle = i * segmentAngle, endAngle = startAngle + segmentAngle;
    gradientString += `${color} ${startAngle}deg ${endAngle}deg, `;
    const labelContainer = document.createElement('div');
    labelContainer.className = 'wheel-label-container';
    const textItem = document.createElement('div');
    textItem.className = 'wheel-label-text';
    textItem.textContent = name.replace(/ /g, "\u00A0");
    const cssRotateAngle = startAngle + (segmentAngle / 2) + 90;
    labelContainer.style.transform = `rotate(${cssRotateAngle}deg)`;
    labelContainer.appendChild(textItem);
    wheelLabelsContainer.appendChild(labelContainer);
  });
  wheel.style.backgroundImage = gradientString.slice(0, -2);
}
rouletteBtn.addEventListener('click', () => { document.getElementById('menu-container').style.display = 'none'; wheelContainer.style.display = 'flex'; createWheel(); });
backRoulette.addEventListener('click', () => { wheelContainer.style.display = 'none'; document.getElementById('menu-container').style.display = 'flex'; });

spinBtn.addEventListener('click', () => {
  if (isSpinning) return;
  isSpinning = true;
  spinBtn.disabled = true;
  const numItems = dishNames.length;
  const segmentAngle = 360 / numItems;
  const winningIndex = Math.floor(Math.random() * numItems);
  const stopAngle = (winningIndex * segmentAngle) + (segmentAngle / 2);
  const targetPosition = 180;
  const normalizedCurrentRotation = (currentRotation % 360 + 360) % 360;
  const rotationNeeded = (targetPosition - stopAngle - normalizedCurrentRotation + 360) % 360;
  const spins = 8;
  const totalRotation = rotationNeeded + (360 * spins);
  currentRotation += totalRotation;
  wheel.style.transform = `rotate(${currentRotation}deg)`;
  wheel.addEventListener('transitionend', () => {
    const winningDish = dishNames[winningIndex];
    updateList(winningDish);
    showNotification(`–í—ã–ø–∞–ª–æ: ${winningDish}`);
    isSpinning = false;
    spinBtn.disabled = false;
  }, { once: true });
});

// –û–°–¢–ê–õ–¨–ù–û–ô JS
categories.forEach(cat => cat.addEventListener('click', () => { const catName = cat.dataset.category; dishesContainers.forEach(dc => dc.classList.toggle('show', dc.dataset.category === catName)); document.querySelector('.categories').style.display = 'none'; backButton.style.display = 'block'; }));
backButton.addEventListener('click', () => { dishesContainers.forEach(dc => dc.classList.remove('show')); document.querySelector('.categories').style.display = 'flex'; backButton.style.display = 'none'; });
const dishCount = {};
function updateList(name) { dishCount[name] = (dishCount[name] || 0) + 1; cart.innerHTML = ''; for (const [dish, count] of Object.entries(dishCount)) { const li = document.createElement('li'); li.textContent = count > 1 ? `${dish} √ó${count}` : dish; cart.appendChild(li); } listBox.style.display = 'block'; }
allDishes.forEach(dish => dish.addEventListener('click', () => updateList(dish.dataset.name)));

document.getElementById('clear').addEventListener('click', () => {
  if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫?")) {
    cart.innerHTML = '';
    listBox.style.display = 'none';
    for (let key in dishCount) delete dishCount[key];
  }
});

checkoutBtn.addEventListener('click', async () => {
  const items = Array.from(document.querySelectorAll('#list li')).map(li => li.textContent);
  if (items.length === 0) {
    alert("–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç!");
    return;
  }
  let noteText = "–ú–æ–π —Å–ø–∏—Å–æ–∫:\n" + items.map(item => `‚òê ${item}`).join('\n');
  if (navigator.share) {
    try { await navigator.share({ title: '–ß—Ç–æ –ø–æ–µ—Å—Ç—å?', text: noteText, }); }
    catch (err) { console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–ø–∏—Å–∫–∞:', err); }
  } else {
    prompt("–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–æ–∫ –¥–ª—è –∑–∞–º–µ—Ç–æ–∫:", noteText);
  }
});

setTimeout(() => { document.querySelector('.loader').style.display = 'none'; document.getElementById('menu-container').style.display = 'flex'; }, 1000);
</script>
</body>
</html>